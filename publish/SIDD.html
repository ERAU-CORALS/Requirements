<!DOCTYPE html>
<html>
<head><title>Doorstop</title>
  <meta charset="utf-8" />
  <meta http-equiv="content-type" content="text/html; charset=UTF-8" />
  <link rel="stylesheet" href="assets/doorstop/bootstrap.min.css" />
  <link rel="stylesheet" href="assets/doorstop/general.css" />
  <link type="text/css" rel="stylesheet" href="assets/doorstop/sidebar.css" />
  <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML" ></script>
  <script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    tex2jax: {inlineMath: [["$","$"],["\\(","\\)"]]}
  });
  </script>
</head>
<body>

  <div class="container-fluid">
    <div class="row">
      <div class="col-lg-2 hidden-sm hidden-xs">
          <nav id="TOC" class="nav nav-stacked fixed sidebar">
              <h3>Table of Contents</h3>
<ul>
<li><a href="#SIDD-001">Introduction</a><ul>
<li><a href="#SIDD-006">Scope</a></li>
<li><a href="#SIDD-007">Background</a></li>
</ul>
</li>
<li><a href="#SIDD-002">Related Documents</a></li>
<li><a href="#SIDD-003">General Command Structure</a><ul>
<li><a href="#SIDD-008">Bluetooth Communication Protocol</a><ul>
<li><a href="#SIDD-009">Message Format</a></li>
<li><a href="#SIDD-010">Valid Targets (TARGET)</a></li>
<li><a href="#SIDD-011">Valid Length (LEN)</a></li>
<li><a href="#SIDD-012">CRC32 Checksum</a></li>
<li><a href="#SIDD-013">Telemetry and Telecommands</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#SIDD-004">Available Commands</a><ul>
<li><a href="#SIDD-014">DARTS Telecommands</a></li>
<li><a href="#SIDD-015">DARTS Telemetry Requests</a></li>
<li><a href="#SIDD-019">CORALS Telemetry Replies</a></li>
</ul>
</li>
<li><a href="#SIDD-005">Telecommand/Telemetry Details</a><ul>
<li><a href="#SIDD-016">Telecommand/Telemetry Keywords</a></li>
<li><a href="#SIDD-017">Telecommand/Telemetry Request Details</a><ul>
<li><a href="#SIDD-018">SET Telecommand</a></li>
</ul>
</li>
</ul>
</li>
</ul>
          </nav>
      </div>
      <div class="col-lg-8" id="main">
        <h1 id="SIDD-001">Introduction</h1>
<p>The CORALS Software Interface Design document was developed by Team CORALS as a design standard and reference for the Software Communication Protocols used on the CORALS Testbed. It is meant to replace the need for requirements specifying the format and breadth of command/data transmission to and from the CORALS Testbed with the client, as the requirements were not derivable from the customer objectives; the customer did not stipulate a standard. This document will serve as a source of design truth for the CORALS Software Communication interfaces.</p>
<h2 id="SIDD-006">Scope <small>SIDD-006</small></h2>
<p>This document contains the software interface design decisions for the CORALS Testbed Control Software and the Host Data Acquisition and Routing Script. This includes decisions on message format, parameters, keywords, valid ranges, and transmission rates.</p>
<h2 id="SIDD-007">Background <small>SIDD-007</small></h2>
<p>TBC</p>
<h1 id="SIDD-002">Related Documents</h1>
<p>This document is related to the CORALS System Requirements Specification, and links will be made as necessary to the relevant System Level Requirements and Subsystem Level Requirements.</p>
<h1 id="SIDD-003">General Command Structure</h1>
<p>The CORALS Software and the Data Acquisition and Remote Telecommand Script (DARTS) will follow a common defined protocol for serial data transmission.</p>
<h2 id="SIDD-008">Bluetooth Communication Protocol</h2>
<p>DARTS and the CORALS Testbed communicate using a Bluetooth Serial connection. This means that loss is possible, and data could be corrupted in transmission. To detect and prevent this, the CORALS Testbed and HDARS will use a restricted, keyword-based communication protocol to minimize error passthrough.</p>
<h3 id="SIDD-009">Message Format <small>SIDD-009</small></h3>
<p>The Bluetooth Serial Bus <strong>SHALL</strong> use the following communication format:</p>
<pre><code>TARGET . LEN PACKET_TYPE, KEY VALUE, KEY VALUE ..., KEY VALUE . CRC32 0xABCDEF01
</code></pre>
<h3 id="SIDD-010">Valid Targets (TARGET) <small>SIDD-010</small></h3>
<p>The Bluetooth Communication bus <strong>SHALL</strong> support two targets:</p>
<table>
<thead>
<tr>
<th>Valid Targets</th>
</tr>
</thead>
<tbody>
<tr>
<td>DARTS</td>
</tr>
<tr>
<td>CORALS</td>
</tr>
</tbody>
</table>
<h3 id="SIDD-011">Valid Length (LEN) <small>SIDD-011</small></h3>
<p>LEN <strong>SHALL</strong> be an unsigned integer decimal numeric value which accounts for the entire message length.</p>
<h3 id="SIDD-012">CRC32 Checksum <small>SIDD-012</small></h3>
<p>The message <strong>SHALL</strong> be proofed by the CRC32 Checksum attached to the end of the message. The checksum will be unique for all messages less than 2^32 characters in length.</p>
<p>The checksum <strong>SHALL</strong> be run on all characters before the CRC32 Keyword.</p>
<p>The checksum <strong>SHALL</strong> be computed on both sides using the following algorithm:</p>
<pre><code class="language-c">uint32_t crc32(const uint8_t *data, uint32_t length)
{
    uint32_t crc = 0xFFFFFFFF;

    for (uint32_t i = 0; i &lt; length; ++i)
    {
        crc ^= data[i];
        for (uint8_t j = 0; j &lt; 8; ++j)
        {
            uint32_t mask = -(crc &amp; 1);
            crc = (crc &gt;&gt; 1) ^ (0xEDB88320 &amp; mask);
        }
    }

    return crc;
}

</code></pre>
<h3 id="SIDD-013">Telemetry and Telecommands <small>SIDD-013</small></h3>
<p>Considering format, there is no difference between Telemetry and Telecommands. However, telemetry is always sent to the DARTS target. Telecommands are available for both targets.</p>
<h1 id="SIDD-004">Available Commands</h1>
<p>There are commands available depending on the target selected. They are enumerated in this section:</p>
<h2 id="SIDD-014">DARTS Telecommands <small>SIDD-014</small></h2>
<p>DARTS <strong>SHALL</strong> support the following telecommands:</p>
<ul>
<li>SET</li>
<li>ECHO</li>
<li>TARGET_ADD</li>
<li>HALT</li>
<li>SET_POWER</li>
<li>SET_INERTIA</li>
<li>SET_CONTROL</li>
<li>SET_SINGULARITY</li>
</ul>
<h2 id="SIDD-015">DARTS Telemetry Requests <small>SIDD-015</small></h2>
<p>DARTS <strong>SHALL</strong> support the following telemetry requests:</p>
<ul>
<li>GET</li>
<li>GET_TARGET</li>
<li>GET_TARGETS</li>
<li>GET_HALT</li>
<li>GET_POWER</li>
<li>GET_INERTIA</li>
<li>GET_CONTROL</li>
<li>GET_SINGULARITY</li>
<li>GET_STATE</li>
<li>GET_ATTITUDE</li>
</ul>
<h2 id="SIDD-019">CORALS Telemetry Replies <small>SIDD-019</small></h2>
<p>CORALS <strong>SHALL</strong> support the following telemetry replies:</p>
<ul>
<li>REGISTER</li>
<li>ECHO_REPLY</li>
<li>CURRENT_TARGET</li>
<li>TARGET_LIST</li>
<li>HALT_STATE</li>
<li>POWER_STATE</li>
<li>INERTIA_MATRIX</li>
<li>CONTROL_STATE</li>
<li>SINGULARITY_STATE</li>
<li>CORALS_STATE</li>
<li>ATTITUDE</li>
</ul>
<h1 id="SIDD-005">Telecommand/Telemetry Details</h1>
<h2 id="SIDD-016">Telecommand/Telemetry Keywords <small>SIDD-016</small></h2>
<p>The valid keywords for CORALS communication are listed below with possible value pairs and packet coorelations.</p>
<p><em>Note: All Keywords supported by SET, GET, and REGISTER</em></p>
<table>
<thead>
<tr>
<th>Keyword</th>
<th>Valid Values</th>
<th>Valid Packet Types</th>
</tr>
</thead>
<tbody>
<tr>
<td>COMM_LR</td>
<td>decimal frequency (Hz)</td>
<td>SET_CONTROL, GET_CONTROL, CONTROL_STATE</td>
</tr>
<tr>
<td>CONTROL_LR</td>
<td>decimal frequency (Hz)</td>
<td>SET_CONTROL, GET_CONTROL, CONTROL_STATE</td>
</tr>
<tr>
<td>ENABLE_OVERRIDE</td>
<td>'ON', 'OFF'</td>
<td>SET_SINGULARITY, GET_SINGULARITY, SINGULARITY_STATE</td>
</tr>
<tr>
<td>GAIN11</td>
<td>decimal</td>
<td>SET_CONTROL, GET_CONTROL, CONTROL_STATE</td>
</tr>
<tr>
<td>GAIN12</td>
<td>decimal</td>
<td>SET_CONTROL, GET_CONTROL, CONTROL_STATE</td>
</tr>
<tr>
<td>GAIN13</td>
<td>decimal</td>
<td>SET_CONTROL, GET_CONTROL, CONTROL_STATE</td>
</tr>
<tr>
<td>GAIN21</td>
<td>decimal</td>
<td>SET_CONTROL, GET_CONTROL, CONTROL_STATE</td>
</tr>
<tr>
<td>GAIN22</td>
<td>decimal</td>
<td>SET_CONTROL, GET_CONTROL, CONTROL_STATE</td>
</tr>
<tr>
<td>GAIN23</td>
<td>decimal</td>
<td>SET_CONTROL, GET_CONTROL, CONTROL_STATE</td>
</tr>
<tr>
<td>GAIN31</td>
<td>decimal</td>
<td>SET_CONTROL, GET_CONTROL, CONTROL_STATE</td>
</tr>
<tr>
<td>GAIN32</td>
<td>decimal</td>
<td>SET_CONTROL, GET_CONTROL, CONTROL_STATE</td>
</tr>
<tr>
<td>GAIN33</td>
<td>decimal</td>
<td>SET_CONTROL, GET_CONTROL, CONTROL_STATE</td>
</tr>
<tr>
<td>GM_MASTER_POWER</td>
<td>'ON', 'OFF'</td>
<td>SET_POWER, GET_POWER, POWER_STATE</td>
</tr>
<tr>
<td>GM0_POWER</td>
<td>'ON', 'OFF'</td>
<td>SET_POWER, GET_POWER, POWER_STATE</td>
</tr>
<tr>
<td>GM1_POWER</td>
<td>'ON', 'OFF'</td>
<td>SET_POWER, GET_POWER, POWER_STATE</td>
</tr>
<tr>
<td>GM2_POWER</td>
<td>'ON', 'OFF'</td>
<td>SET_POWER, GET_POWER, POWER_STATE</td>
</tr>
<tr>
<td>GM3_POWER</td>
<td>'ON', 'OFF'</td>
<td>SET_POWER, GET_POWER, POWER_STATE</td>
</tr>
<tr>
<td>GM4_POWER</td>
<td>'ON', 'OFF'</td>
<td>SET_POWER, GET_POWER, POWER_STATE</td>
</tr>
<tr>
<td>GM5_POWER</td>
<td>'ON', 'OFF'</td>
<td>SET_POWER, GET_POWER, POWER_STATE</td>
</tr>
<tr>
<td>GM6_POWER</td>
<td>'ON', 'OFF'</td>
<td>SET_POWER, GET_POWER, POWER_STATE</td>
</tr>
<tr>
<td>GM7_POWER</td>
<td>'ON', 'OFF'</td>
<td>SET_POWER, GET_POWER, POWER_STATE</td>
</tr>
<tr>
<td>GM8_POWER</td>
<td>'ON', 'OFF'</td>
<td>SET_POWER, GET_POWER, POWER_STATE</td>
</tr>
<tr>
<td>GM9_POWER</td>
<td>'ON', 'OFF'</td>
<td>SET_POWER, GET_POWER, POWER_STATE</td>
</tr>
<tr>
<td>GMA_POWER</td>
<td>'ON', 'OFF'</td>
<td>SET_POWER, GET_POWER, POWER_STATE</td>
</tr>
<tr>
<td>GMB_POWER</td>
<td>'ON', 'OFF'</td>
<td>SET_POWER, GET_POWER, POWER_STATE</td>
</tr>
<tr>
<td>GMC_POWER</td>
<td>'ON', 'OFF'</td>
<td>SET_POWER, GET_POWER, POWER_STATE</td>
</tr>
<tr>
<td>GMD_POWER</td>
<td>'ON', 'OFF'</td>
<td>SET_POWER, GET_POWER, POWER_STATE</td>
</tr>
<tr>
<td>GME_POWER</td>
<td>'ON', 'OFF'</td>
<td>SET_POWER, GET_POWER, POWER_STATE</td>
</tr>
<tr>
<td>GMF_POWER</td>
<td>'ON', 'OFF'</td>
<td>SET_POWER, GET_POWER, POWER_STATE</td>
</tr>
<tr>
<td>Q0</td>
<td>decimal [0, 1]</td>
<td>TARGET_ADD, GET_TARGET, CURRENT_TARGET</td>
</tr>
<tr>
<td>Q1</td>
<td>decimal [0, 1]</td>
<td>TARGET_ADD, GET_TARGET, CURRENT_TARGET</td>
</tr>
<tr>
<td>Q2</td>
<td>decimal [0, 1]</td>
<td>TARGET_ADD, GET_TARGET, CURRENT_TARGET</td>
</tr>
<tr>
<td>Q3</td>
<td>decimal [0, 1]</td>
<td>TARGET_ADD, GET_TARGET, CURRENT_TARGET</td>
</tr>
<tr>
<td>Q4</td>
<td>decimal [0, 1]</td>
<td>TARGET_ADD, GET_TARGET, CURRENT_TARGET</td>
</tr>
<tr>
<td>QUAT_FORMAT</td>
<td>'Q0', 'Q4'</td>
<td>TARGET_ADD, GET_TARGET, CURRENT_TARGET</td>
</tr>
<tr>
<td>SINGULARITY_HALTING</td>
<td>'ON', 'OFF'</td>
<td>SET_SINGULARITY, GET_SINGULARITY, SINGULARITY_STATE</td>
</tr>
<tr>
<td>SINGULARITY_THOLD</td>
<td>decimal [0, 1]</td>
<td>SET_SINGULARITY, GET_SINGULARITY, SINGULARITY_STATE</td>
</tr>
<tr>
<td>SINGULARITY_TRIP</td>
<td>'SET', 'RESET'</td>
<td>SET_SINGULARITY, GET_SINGULARITY, SINGULARITY_STATE</td>
</tr>
<tr>
<td>SM_MASTER_POWER</td>
<td>'ON', 'OFF'</td>
<td>SET_POWER, GET_POWER, POWER_STATE</td>
</tr>
<tr>
<td>SM0_POWER</td>
<td>'ON', 'OFF'</td>
<td>SET_POWER, GET_POWER, POWER_STATE</td>
</tr>
<tr>
<td>SM1_POWER</td>
<td>'ON', 'OFF'</td>
<td>SET_POWER, GET_POWER, POWER_STATE</td>
</tr>
<tr>
<td>SM2_POWER</td>
<td>'ON', 'OFF'</td>
<td>SET_POWER, GET_POWER, POWER_STATE</td>
</tr>
<tr>
<td>SM3_POWER</td>
<td>'ON', 'OFF'</td>
<td>SET_POWER, GET_POWER, POWER_STATE</td>
</tr>
<tr>
<td>SM4_POWER</td>
<td>'ON', 'OFF'</td>
<td>SET_POWER, GET_POWER, POWER_STATE</td>
</tr>
<tr>
<td>SM5_POWER</td>
<td>'ON', 'OFF'</td>
<td>SET_POWER, GET_POWER, POWER_STATE</td>
</tr>
<tr>
<td>SM6_POWER</td>
<td>'ON', 'OFF'</td>
<td>SET_POWER, GET_POWER, POWER_STATE</td>
</tr>
<tr>
<td>SM7_POWER</td>
<td>'ON', 'OFF'</td>
<td>SET_POWER, GET_POWER, POWER_STATE</td>
</tr>
<tr>
<td>SM8_POWER</td>
<td>'ON', 'OFF'</td>
<td>SET_POWER, GET_POWER, POWER_STATE</td>
</tr>
<tr>
<td>SM9_POWER</td>
<td>'ON', 'OFF'</td>
<td>SET_POWER, GET_POWER, POWER_STATE</td>
</tr>
<tr>
<td>SMA_POWER</td>
<td>'ON', 'OFF'</td>
<td>SET_POWER, GET_POWER, POWER_STATE</td>
</tr>
<tr>
<td>SMB_POWER</td>
<td>'ON', 'OFF'</td>
<td>SET_POWER, GET_POWER, POWER_STATE</td>
</tr>
<tr>
<td>SMC_POWER</td>
<td>'ON', 'OFF'</td>
<td>SET_POWER, GET_POWER, POWER_STATE</td>
</tr>
<tr>
<td>SMD_POWER</td>
<td>'ON', 'OFF'</td>
<td>SET_POWER, GET_POWER, POWER_STATE</td>
</tr>
<tr>
<td>SME_POWER</td>
<td>'ON', 'OFF'</td>
<td>SET_POWER, GET_POWER, POWER_STATE</td>
</tr>
<tr>
<td>SMF_POWER</td>
<td>'ON', 'OFF'</td>
<td>SET_POWER, GET_POWER, POWER_STATE</td>
</tr>
<tr>
<td>TARGET0</td>
<td>{decimal (Hex)} x 4</td>
<td>TARGET_LIST</td>
</tr>
<tr>
<td>TARGET1</td>
<td>{decimal (Hex)} x 4</td>
<td>TARGET_LIST</td>
</tr>
<tr>
<td>TARGET2</td>
<td>{decimal (Hex)} x 4</td>
<td>TARGET_LIST</td>
</tr>
<tr>
<td>TARGET3</td>
<td>{decimal (Hex)} x 4</td>
<td>TARGET_LIST</td>
</tr>
<tr>
<td>TARGET4</td>
<td>{decimal (Hex)} x 4</td>
<td>TARGET_LIST</td>
</tr>
<tr>
<td>TARGET5</td>
<td>{decimal (Hex)} x 4</td>
<td>TARGET_LIST</td>
</tr>
<tr>
<td>TARGET6</td>
<td>{decimal (Hex)} x 4</td>
<td>TARGET_LIST</td>
</tr>
<tr>
<td>TARGET7</td>
<td>{decimal (Hex)} x 4</td>
<td>TARGET_LIST</td>
</tr>
<tr>
<td>TARGET8</td>
<td>{decimal (Hex)} x 4</td>
<td>TARGET_LIST</td>
</tr>
<tr>
<td>TARGET9</td>
<td>{decimal (Hex)} x 4</td>
<td>TARGET_LIST</td>
</tr>
<tr>
<td>TARGETA</td>
<td>{decimal (Hex)} x 4</td>
<td>TARGET_LIST</td>
</tr>
<tr>
<td>TARGETB</td>
<td>{decimal (Hex)} x 4</td>
<td>TARGET_LIST</td>
</tr>
<tr>
<td>TARGETC</td>
<td>{decimal (Hex)} x 4</td>
<td>TARGET_LIST</td>
</tr>
<tr>
<td>TARGETD</td>
<td>{decimal (Hex)} x 4</td>
<td>TARGET_LIST</td>
</tr>
<tr>
<td>TARGETE</td>
<td>{decimal (Hex)} x 4</td>
<td>TARGET_LIST</td>
</tr>
<tr>
<td>TARGETF</td>
<td>{decimal (Hex)} x 4</td>
<td>TARGET_LIST</td>
</tr>
</tbody>
</table>
<h2 id="SIDD-017">Telecommand/Telemetry Request Details</h2>
<h3 id="SIDD-018">SET Telecommand <small>SIDD-018</small></h3>
      </div>
    </div>
</div>
<!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
<script src="assets/doorstop/jquery.min.js"></script>
<script src="assets/doorstop/bootstrap.min.js"></script>
<script>
    $(function() {
        $("table").addClass("table");
        $("nav ul").addClass("nav nav-stacked");
        $("nav").affix();
        $('body').scrollspy({
          target: '.sidebar'
        });
        $("#main a").attr("target", "parent");

  $(window).on('hashchange', function() {
    $(window).scrollTop($(location.hash.toLowerCase()).offset().top);});
  });
</script>
</body>
</html>

